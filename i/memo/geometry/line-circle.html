<?xml version="1.0" encoding="utf-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML Basic 1.0//EN" "http://www.w3.org/TR/xhtml-basic/xhtml-basic10.dtd"><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>直線と円の交点を求める - Shogo Computing Laboratory</title>

<style>
.suffix-sorted {
    color: red;
}
.suffix-end {
    background: #88F;
}
.suffix-a {
    background: #8F8;
}
.suffix-b {
    background: #8FF;
}
.suffix-c {
    background: #F88;
}
.suffix-d {
    background: #F8F;
}
.suffix-r {
    background: #FF8;
}
.suffix td:nth-child(1) {
    width: 2ex;
    text-align: right;
}
.suffix td:nth-child(2) {
    text-align: right;
}
.suffix td:nth-child(3) {
    width: 15ex;
    text-align: left;
}

</style>

</head>

<body>

<a href="http://analytics.qlook.net/" target="_blank">
<img src="http://ec16090p.analytics.qlook.net/counter.png" id="ec16090p.analytics.qlook.net" alt="QLOOKアクセス解析" width="80" height="15" border="0" />
</a>
<script type="text/javascript" src="http://ec16090p.analytics.qlook.net/analyze.js" charset="UTF-8" defer="defer"></script>
<noscript>
<div><iframe src="http://ec16090p.analytics.qlook.net/analyze.html?url=http://sora-blue.net/~shogo82148/memo/geometry/line-circle.html&amp;ttl=直線と円の交点を求める" title="QLOOKアクセス解析" style="width:1px;height:1px;">
<img src="http://ec16090p.analytics.qlook.net/analyze.gif?guid=ON&amp;url=http://sora-blue.net/~shogo82148/memo/geometry/line-circle.html&amp;ttl=直線と円の交点を求める" alt="QLOOKアクセス解析" width="1" height="1" />
</iframe></div></noscript>







<div class="subinfo">
<p class="label">目次</p>
<ul><li><a href="#implicit">陰関数で表わす</a></li><li><a href="#parametric">媒介変数表示で表わす</a></li><li><a href="#svg">実際にやってみよう</a></li></ul>
</div>


<h1>直線と円の交点を求める</h1>
<navi id="breadNavi"><a href="../../">HOME</a>&gt;&gt;<a href="../">メモ</a>&gt;&gt;<a href="./">図形処理の基礎</a>&gt;&gt;直線と円の交点を求める</navi>


<h2 id="implicit">陰関数で表わす</h2>
<p>
直線と円の交点について考えてみます。
点<img src="../../../memo/geometry/eqn/7b21584bcd06a236f680835e42398f39.gif" alt="$(x_\mathrm{P},y_\mathrm{P})$" width="39" height="12" class="equation" />を中心とした半径<img src="../../../memo/geometry/eqn/89f2e0d2d24bcf44db73aab8fc03252c.gif" alt="$r$" width="6" height="5" class="equation" />の円と、直線<img src="../../../memo/geometry/eqn/efa25205cb985c034fcb97a21f4f8fff.gif" alt="$ax+by+c=0$" width="80" height="10" class="equation" />の交点を考えます。
</p>
<object data="../../../memo/geometry/line-circle1.svg" type="image/svg+xml" ><img src="../../../memo/geometry/line-circle1.png" /></object>

<p>
上の図で、点Hの座標は「<a href="./point-line.html">点と直線の距離を求める</a>」で求めました。
<img src="../../../memo/geometry/eqn/45f76a341331add7516689c5cdcf2cc1.gif" alt="$d=ax_\mathrm{P}+by_\mathrm{P}+c$" width="95" height="10" class="equation" />と置けば、点Hの座標は次のように書けます。
</p>
<img src="../../../memo/geometry/eqn/9da7e09c25e0e9a8ba92b5c306b07882.gif" alt="\begin{eqnarray*} x &amp;=&amp; x_\mathrm{P} - a\frac{d}{a^2+b^2} \\ y &amp;=&amp; y_\mathrm{P} - b\frac{d}{a^2+b^2} \end{eqnarray*}" width="96" height="55" class="eqn" />

<p>
次に線分HQの長さを考えます。この長さは三平方の定理から簡単に求めることができます。
線分OHの長さは<img src="../../../memo/geometry/eqn/a4c5e9f2e8f5da9365c35e8e0375cfe9.gif" alt="$d/\sqrt{a^2+b^2}$" width="59" height="14" class="equation" />なので
</p>
<img src="../../../memo/geometry/eqn/bb0ee930156cd39762be2e7a41a570d0.gif" alt="\[ \mathrm{HQ} = \sqrt{r^2-\frac{d^2}{a^2+b^2}} \]" width="112" height="30" class="eqn" />
<p>
となります。
</p>
<p>
ここで、直線に沿った向きのベクトルを<img src="../../../memo/geometry/eqn/11d46fbfbd78793e7e928def7e4f66a1.gif" alt="$\overrightarrow{w}$" width="12" height="10" class="equation" />とすると
</p>
<img src="../../../memo/geometry/eqn/66b0dddaf57a940c26978dbd481d7227.gif" alt="\[ \overrightarrow{\mathrm{HQ}} = \pm \sqrt{r^2-\frac{d^2}{a^2+b^2}}\frac{\overrightarrow{w}}{|\overrightarrow{w}|} \]" width="140" height="30" class="eqn" />
<p>
と書くことができます。
<img src="../../../memo/geometry/eqn/11d46fbfbd78793e7e928def7e4f66a1.gif" alt="$\overrightarrow{w}$" width="12" height="10" class="equation" />は<img src="../../../memo/geometry/eqn/a9a2dbad70b7afbe24ab063a09899fa2.gif" alt="$\overrightarrow{v}$" width="12" height="10" class="equation" />と直交するベクトルなので<img src="../../../memo/geometry/eqn/6e47310c452688bc7932ffd6eb1a100e.gif" alt="$\overrightarrow{w}=(b,-a)$" width="62" height="13" class="equation" />です。
</p>
<p>
これで点Hの座標と、点Hと点Qの相対座標がわかりました。
後はこれらを足しあわせれば点Qの座標が出ます。
</p>

<img src="../../../memo/geometry/eqn/f84d06255a9b62bad283b5e4728a510b.gif" alt="\begin{eqnarray*} x &amp;=&amp; x_\mathrm{P} - a\frac{d}{a^2+b^2} \pm \sqrt{r^2-\frac{d^2}{a^2+b^2}}\frac{b}{\sqrt{a^2+b^2}}\\ y &amp;=&amp; y_\mathrm{P} - b\frac{d}{a^2+b^2} \mp \sqrt{r^2-\frac{d^2}{a^2+b^2}}\frac{a}{\sqrt{a^2+b^2}} \end{eqnarray*}" width="236" height="67" class="eqn" />

<p>
これをまとめると点Pの座標は次式のようになります。
</p>

<img src="../../../memo/geometry/eqn/ddc880db4c1a58e6225ca50116d25956.gif" alt="\begin{eqnarray*} x &amp;=&amp; \frac{-ad \pm b\sqrt{(a^2+b^2)r^2 - d^2}}{a^2+b^2} + x_\mathrm{P} \\ y &amp;=&amp; \frac{-bd \mp a\sqrt{(a^2+b^2)r^2 - d^2}}{a^2+b^2} + y_\mathrm{P} \end{eqnarray*}" width="190" height="61" class="eqn" />

<p>
特に、円の中心が原点の場合、<img src="../../../memo/geometry/eqn/04963596bc1d116558e5a56a162e8d5f.gif" alt="$d=c$" width="28" height="8" class="equation" />となります。
</p>


<h2 id="parametric">媒介変数表示で表わす</h2>
<p>
直線が媒介変数表示されている場合についても考えてみます。
</p>
<img src="../../../memo/geometry/eqn/de24c5483e73b4f5918b634b69738b0f.gif" alt="\begin{eqnarray*} x &amp;=&amp; at + x_0\\ y &amp;=&amp; bt + y_0 \end{eqnarray*}" width="59" height="27" class="eqn" />

<p>
まずは点Hの座標ですが、「<a href="./point-line.html">点と直線の距離を求める</a>」で求めたように
</p>
<img src="../../../memo/geometry/eqn/fcd9b612d468eedad5369b809e170c86.gif" alt="\[ t=\frac{a(x_\mathrm{P}-x_0)+b(y_\mathrm{P}-y_0)}{a^2+b^2} \]" width="146" height="26" class="eqn" />
<p>
となる<img src="../../../memo/geometry/eqn/4f4f4e395762a3af4575de74c019ebb5.gif" alt="$t$" width="4" height="7" class="equation" />の点です。
</p>
<p>
<img src="../../../memo/geometry/eqn/78e32856f87ba945cfedde7db2e58adc.gif" alt="$d=a(y_\mathrm{P}-y_0)-b(x_\mathrm{P}-x_0)$" width="145" height="12" class="equation" />とすれば、陰関数表示の場合と同様に
</p>
<img src="../../../memo/geometry/eqn/bb0ee930156cd39762be2e7a41a570d0.gif" alt="\[ \mathrm{HQ} = \sqrt{r^2-\frac{d^2}{a^2+b^2}} \]" width="112" height="30" class="eqn" />
<p>
です。これから、
</p>
<img src="../../../memo/geometry/eqn/4f5bde65eb1a238983ba969192a793cf.gif" alt="\begin{eqnarray*} t &amp;=&amp; \frac{a(x_\mathrm{P}-x_0)+b(y_\mathrm{P}-y_0)}{a^2+b^2} \pm \sqrt{r^2-\frac{d^2}{a^2+b^2}}\frac{1}{\sqrt{a^2+b^2}}\\ &amp;=&amp; \frac{a(x_\mathrm{P}-x_0)+b(y_\mathrm{P}-y_0) \pm \sqrt{(a^2+b^2)r^2 - d^2}}{a^2+b^2} \end{eqnarray*}" width="286" height="64" class="eqn" />

<h2 id="svg">実際にやってみよう</h2>
<p>
実際にやってみました。
SVGにJavascriptを埋め込んで簡単なアニメーションを作ってみました。
黒の直線と円が与えられた時の交点を求めます。赤の小さい円が交点です。<br />
<a href="./line-circle.svg">SVGファイルをダウンロードする</a>
</p>
<object data="./line-circle.svg" type="image/svg+xml" width="400" height="300">
残念ながら現在使用しているブラウザでは表示できません。
IE以外のブラウザの最新版をダウンロードしてください。
</object>


<ul class="toInfo">
	<li><a href="./">サイトトップへ</a></li>
</ul>

</body>
</html>