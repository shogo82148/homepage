<?xml version="1.0" encoding="utf-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML Basic 1.0//EN" "http://www.w3.org/TR/xhtml-basic/xhtml-basic10.dtd"><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>最急降下法 - Shogo Computing Laboratory</title>

</head>

<body>

<a href="http://analytics.qlook.net/" target="_blank">
<img src="http://ec16090p.analytics.qlook.net/counter.png" id="ec16090p.analytics.qlook.net" alt="QLOOKアクセス解析" width="80" height="15" border="0" />
</a>
<script type="text/javascript" src="http://ec16090p.analytics.qlook.net/analyze.js" charset="UTF-8" defer="defer"></script>
<noscript>
<div><iframe src="http://ec16090p.analytics.qlook.net/analyze.html?url=http://sora-blue.net/~shogo82148/memo/algorithm/steepest-descent/index.html&amp;ttl=最急降下法" title="QLOOKアクセス解析" style="width:1px;height:1px;">
<img src="http://ec16090p.analytics.qlook.net/analyze.gif?guid=ON&amp;url=http://sora-blue.net/~shogo82148/memo/algorithm/steepest-descent/index.html&amp;ttl=最急降下法" alt="QLOOKアクセス解析" width="1" height="1" />
</iframe></div></noscript>







<div class="subinfo">
<p class="label">目次</p>
<ul><li><a href="#one">一変数の最適化問題</a></li><li><a href="#proof">証明</a></li><li><a href="#multi">多変数の最適化問題</a></li><li><a href="#svg">実際にやってみよう</a></li></ul>
</div>


<h1>最急降下法</h1>
<navi id="breadNavi"><a href="../../../">HOME</a>&gt;&gt;<a href="../../">メモ</a>&gt;&gt;<a href="../">アルゴリズム</a>&gt;&gt;最急降下法</navi>



<h2 id="one">一変数の最適化問題</h2>
<p>
「最急降下法」とは関数の最小値(または最大値)を求める手法です。
単純で計算量が少ないのでよく使われる方法です。
</p>
<p>
最適化したい関数を目的関数と呼びます。
これを<img src="../../../../memo/algorithm/steepest-descent/7997339883ac20f551e7f35efff0a2b9.gif" alt="$f(x)$" width="23" height="12" class="equation" />としましょう。
これを最小化を考えます。最大化したい場合は<img src="../../../../memo/algorithm/steepest-descent/7519ee285703d0ec55d60b90385a2719.gif" alt="$-f(x)$" width="32" height="12" class="equation" />の最小化をすればいいだけです。
</p>
<p>
今、<img src="../../../../memo/algorithm/steepest-descent/332cc365a4987aacce0ead01b8bdcc0b.gif" alt="$x$" width="7" height="5" class="equation" />が適当な値<img src="../../../../memo/algorithm/steepest-descent/5ef6a7263760e4096fc413d70b26c709.gif" alt="$x=x(t)$" width="43" height="12" class="equation" />としましょう。
最急降下法では<img src="../../../../memo/algorithm/steepest-descent/332cc365a4987aacce0ead01b8bdcc0b.gif" alt="$x$" width="7" height="5" class="equation" />を次のように更新します。
<img src="../../../../memo/algorithm/steepest-descent/b2bc420d5590474e64e16e80687e19ef.gif" alt="$x(t+1)=x(t)-\alpha\displaystyle\frac{\partial f(x)}{\partial x}$" width="132" height="27" class="eqn" />
ここで、αは小さな正の定数です。これを繰り返すことで最小値に近づいていきます。
</p>
<p>
αがあまり大きすぎると最小値を行き過ぎ、小さすぎるとなかなか収束しません。
また、極小値があるとそこに収束してしまう場合があるのが問題です。
</p>

<h2 id="proof">証明</h2>
<p>
授業でこんな感じで習ったような、という覚え書き。
僕の解釈も含まれているので、間違っているかも。
</p>
<p>
変数xがtの関数であり、<img src="../../../../memo/algorithm/steepest-descent/5ef6a7263760e4096fc413d70b26c709.gif" alt="$x=x(t)$" width="43" height="12" class="equation" />とします。
このとき、目的関数fをtについて微分してみましょう。
<img src="../../../../memo/algorithm/steepest-descent/7710c0e40a4c42d75e6e36bad07d117b.gif" alt="$\displaystyle \frac{\mathrm{d}}{\mathrm{d}t}f(x(t))=\frac{\partial f(x)}{\partial x}\frac{\mathrm{d}x}{\mathrm{d}t}$" width="114" height="27" class="eqn" />
となります。ここでαを正の定数とし、<img src="../../../../memo/algorithm/steepest-descent/f92a2fed82f1dacdec6e4d5a05fbbf97.gif" alt="$x(t)$" width="20" height="12" class="equation" />が
<img src="../../../../memo/algorithm/steepest-descent/deeeb735f956126de362c73ec0639e88.gif" alt="$\displaystyle\frac{\mathrm{d}x}{\mathrm{d}t}=-\alpha\frac{\partial f(x)}{\partial x}$" width="80" height="27" class="eqn" />
を満たすものとすると、
<img src="../../../../memo/algorithm/steepest-descent/770ed8e3441bc7c4365d5b846f718b38.gif" alt="$\displaystyle\frac{\mathrm{d}}{\mathrm{d}t}f(x(t))=-\alpha\left(\frac{\partial f(x)}{\partial x}\right)^2$" width="140" height="32" class="eqn" />
αも正、<img src="../../../../memo/algorithm/steepest-descent/8c5c1fa0cd1f6a4c4dc19cb310c38d6b.gif" alt="$\displaystyle\left(\frac{\partial f(x)}{\partial x}\right)^2$" width="53" height="32" class="equation" />も正なので、微分係数は常に負となります。
従って関数fはtに関して減少関数となります。
</p>
<p>
最急降下法はこのような関数<img src="../../../../memo/algorithm/steepest-descent/f92a2fed82f1dacdec6e4d5a05fbbf97.gif" alt="$x(t)$" width="20" height="12" class="equation" />を数値解析的に求め、tを無限大とすることに対応しているわけです。
</p>

<h2 id="multi">多変数の最適化問題</h2>
<p>
最急降下法は最適化するべき変数が複数ある場合にも適用できます。
目的関数fが、n個の変数<img src="../../../../memo/algorithm/steepest-descent/b98697d30f7b8b603e8dc0c5e82fba9e.gif" alt="$\bm{x}=[x_1,x_2,\dots,x_n]^\mathrm{T}$" width="106" height="13" class="equation" />の関数だとします。
このとき、
<img src="../../../../memo/algorithm/steepest-descent/ec517249d6bd912e61aca0324a9ffea7.gif" alt="$\bm{x}(t+1)=\bm{x}(t)-\alpha\nabla f(\bm{x})=\bm{x}(t)-\alpha\left[\begin{array}{c}\displaystyle\frac{\partial f(x_1)}{\partial x_1}\\\vdots\\\displaystyle\frac{\partial f(x_n)}{\partial x_n}\end{array}\right]$" width="260" height="79" class="eqn" />
によって最適化できます。
</p>

<h2 id="svg">実際にやってみよう</h2>
<p>
一変数の場合について、実際にやってみました。
例によって、SVGにJavascriptを埋め込んだ簡単なアニメーションです。
黒い曲線が目的関数。赤い点たちが最急降下法によって求めた最適値です。
初めは等間隔に並んでいた点が関数の最小値に近づいていきますが、極小値に収束するものがあることを確認できます。
<a href="./steepest.svg">SVGファイルをダウンロードする</a>
</p>
<object data="./steepest.svg" type="image/svg+xml" width="400" height="300">
<param name="alpha" value="0.002" />
残念ながら現在使用しているブラウザでは表示できません。
IE以外のブラウザの最新版をダウンロードしてください。
</object>
<p>
更新量を大きくしてみましょう。最小値を行き過ぎてしまって、なかなか収束しないことが確認できます。
</p>
<object data="./steepest.svg" type="image/svg+xml" width="400" height="300">
<param name="alpha" value="0.05" />
残念ながら現在使用しているブラウザでは表示できません。
IE以外のブラウザの最新版をダウンロードしてください。
</object>


<ul class="toInfo">
	<li><a href="./">サイトトップへ</a></li>
</ul>

</body>
</html>